{% load staticfiles %}

<!DOCTYPE html>
<html>

<head>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script type="text/javascript" src="{% static 'js/shared/angular.min.js'%}"></script>
    <script type="text/javascript" src="{% static 'js/shared/ng-map.min.js'%}"></script>

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <!-- <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyASBVxPbc_Fo1LKVLeEmsdt4UHdS5O71E8&callback=initMap"></script> -->
    <script src="http://maps.google.com/maps/api/js?key=AIzaSyASBVxPbc_Fo1LKVLeEmsdt4UHdS5O71E8"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="{% static 'css/index.css'%}" >

    <script type="text/javascript" src="{% static 'js/index.js'%}"></script>
    <!-- Modules -->
    <script type="text/javascript" src="{% static 'js/app.js'%}"></script>
    <!-- Controllers -->
    <script type="text/javascript" src="{% static 'js/controllers/indexController.js'%}"></script>
    <!-- Directives -->
    <script type="text/javascript" src="{% static 'js/directives/newEventConfirmation.js'%}"></script>
    <script type="text/javascript">
    var userId = 1;
    var labels = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
    var labelIndex = 0;
    var map;

    function initialize() {
        var currLatLng = {
            lat: {{ lat }},
            lng: {{ lng }}
        };
        map = new google.maps.Map(document.getElementById('map'), {
            center: currLatLng,
            zoom: 15
        });

        google.maps.event.addListener(map, 'click', function(event) {
            addMarker(event.latLng, map);
            //newEventRequest(userId, "test", event.latLng.lat(), event.latLng.lng());
        });
        addMarker(currLatLng, map);
        updateLocation(userId, currLatLng["lat"], currLatLng["lng"]);
    }

    function addMarker(location, map) {
        var marker = new google.maps.Marker({
            position: location,
            label: labels[labelIndex++ % labels.length],
            map: map
        });
    }
    google.maps.event.addDomListener(window, 'load', initialize);
    </script>
</head>

<body ng-app="Appointments">
<div id="panel">
  <p>
    Check your appointments here:
  </p>
  <div id="newEventsCreator" ng-controller="newEventConfirmation">
    <new-event-confirmation></new-event-confirmation>
  </div>
</div>
    <div id="map" ng-controller="mapEventsController" ng-click="newEventConfirmation(event)">
      <ng-map default-style="false" zoom="15" center="[{{lat}}, {{lng}}]" ></ng-map>
       <!-- <input id="search-box" class="control" type="text" placeholder="Search Box" /> -->
     </div>
</body>

</html>
